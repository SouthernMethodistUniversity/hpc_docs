---
cluster: "m3cluster"
form:
  - auto_accounts
  - r_module
  - environment
  - custom_queues
  - bc_num_hours
  - rserver_timeout
  - bc_num_cores
  - bc_num_memory
attributes:
  auto_accounts:
   help: |
     Select a Slurm account. By default all users have a  default "smu" account.
     You may have other accounts, e.g. to access course specific material or
     special allocations.
  r_module:
    widget: select
    label: "R Version"
    options:
      - [ "4.3.0", "R/4.3.0" ]
      - [ "4.2.3", "R/4.2.3" ]
      - [ "stat 3341", "/hpc/m3/containers/classes/2023/june_b/stat3341/stat3341_4.3.0.lua",
          data-option-for-auto-accounts-smu: false
        ]
  environment:
    widget: text_area
    label: "Custom Environment Settings"
    help: |
      Set custom environment variables, module paths via `module use
      <path_to_modules>`, and additional modules via `module load
      <space_separated_list_of_modules>`.
  custom_queues:
    label: "Partition"
    widget: select
    help: |
      Please select the SLURM partition to submit the job to.
    options:
      - ["Development Queue (2 hour limit)", "dev",
        data-max-bc-num-hours: 2,
        data-max-bc-num-cores: 128,
        data-max-bc-num-memory: 500,
        ]
      - ["HTC Queue (12 hour limit, 1 core)", "htc",
        data-max-bc-num-hours: 12,
        data-max-bc-num-cores: 1,
        data-max-bc-num-memory: 500,
        ]
      - ["Standard Memory Queue (12 hour limit)", "standard-s",
        data-max-bc-num-hours: 12,
        data-max-bc-num-cores: 128,
        data-max-bc-num-memory: 500,
        ]
      - ["High Memory Queue (12 hour limit)", "highmem",
        data-max-bc-num-hours: 12,
        data-max-bc-num-cores: 128,
        data-max-bc-num-memory: 2000,
        ]
  bc_num_hours:
    label: Time (Hours)
    help: |
      - Number of hours to allocate
      - Exceeding walltime time will automaticaly stop this job.
    cacheable: true
    widget: number_field
    max: 12
    min: 1
    step: 1
    value: 1
  rserver_timeout:
    label: Timeout (minutes)
    help: |
      - Time in minutes before a job is cancelled for being idle
    max: 60
    min: 15
    step: 1
    value: 30
    widget: number_field
  bc_num_cores:
    label: "Cores per node"
    help: Number of CPU threads
    cacheable: true
    widget: number_field
    max: 128
    min: 1
    value: 1
  bc_num_memory:
    label: "Memory"
    help: "Please select the amount of memory (in GB) you need for your job."
    widget: number_field
    max: 500
    min: 1
    step: 1
    value: 4
