Bootstrap: docker
From: linuxserver/code-server:${TAG}

%labels
    Author John LaGrone <jlagrone@smu.edu>
    Version 1.0
    Framework Open OnDemand
    Distribution Ubuntu 22.04
    Application Code Server

%post

  # probably way more than we need
  apt-get -y update
  DEBIAN_FRONTEND=noninteractive apt-get -y install \
               lua5.3 \
               lua5.4 \
               lua-bit32:amd64 \
               lua-posix:amd64 \
               lua-posix-dev \
               lua-filesystem \
               liblua5.3-0:amd64 \
               liblua5.3-dev:amd64 \
               liblua5.4-0:amd64 \
               liblua5.4-dev:amd64 \
               tcl \
               tcl-dev \
               tcl8.6 \
               tcl8.6-dev:amd64 \
               libtcl8.6:amd64 \
               zsh \
               tcsh \
               ksh \
               gcc \
               gfortran \
               gcc-11 \
               g++-11 \
               gfortran-11 \
               make \
               wget \
               git

  update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-13 100
  update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-11 110
  update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-11 110
  update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-13 100
  update-alternatives --install /usr/bin/gfortran gfortran /usr/bin/gfortran-11 110
  update-alternatives --install /usr/bin/gfortran gfortran /usr/bin/gfortran-13 100
  # Clean up
  rm -rf /var/lib/apt/lists/*
